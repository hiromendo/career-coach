import streamlit as st
import pandas as pd

# --- Main Title ---
st.title("IV. High-Demand Adjacent Career Pathways in NYC 🚀")
st.markdown("""
Leveraging your substantial experience in energy sector equity L/S analysis and your strong quantitative
background, several adjacent career pathways in NYC offer excellent prospects. These roles capitalize
on your existing skills while providing avenues for growth, potentially in the expanding energy
transition and sustainable finance sectors.
""")

st.divider()

# --- Section A: Energy Portfolio Management & Hedge Fund Analyst/PM Roles ---
st.header("A. Energy Portfolio Management & Hedge Fund Analyst/PM Roles 📈")
st.caption("(Directly Leveraging L/S Experience)")

with st.expander("Learn more about Energy Portfolio Management & Hedge Fund Roles"):
    st.subheader("📝 Description")
    st.markdown("""
    These roles involve managing portfolios of energy-related equities, encompassing both traditional
    (oil & gas, utilities) and increasingly, renewable energy assets, often within a long/short,
    event-driven, or relative value strategy. Core responsibilities include deep fundamental research,
    financial modeling, market trend analysis, idea generation, trade execution, and rigorous risk
    management.
    """)

    st.subheader("🎯 Relevance")
    st.markdown("""
    This is the most direct application of your experience at Millennium, Citadel, and Fore Research.
    Your demonstrated ability to autonomously manage significant capital (e.g., the **$850mm carve-out
    at Citadel**), consistently achieve strong performance (**Sharpe >1**), identify mispriced securities,
    and make impactful sector calls (e.g., shorting leveraged energy companies) are precisely what
    these roles demand.
    """)

    st.subheader("🏙️ NYC Demand & Employers")
    st.markdown("""
    New York City remains the global hub for hedge funds and asset management. Opportunities exist
    within multi-strategy funds, dedicated energy-focused funds, and traditional asset managers
    expanding their energy coverage. Recruiters like Selby Jennings frequently list such positions,
    including "Equity Long Short - Energy Portfolio Manager"³ and "Oil or Natural Gas Portfolio Manager".¹²
    ZipRecruiter also features "Energy Portfolio Manager" roles across various firm types.²⁸
    """)

    st.subheader("💰 Estimated NYC Salary Range")
    st.markdown("""
    Compensation is highly variable and performance-driven.
    * **Analysts:** Base salaries from **\$150,000 to \$250,000+**, with significant bonus potential.
    * **Portfolio Managers:** (with proven track record) Total compensation ranging from
        **\$250,000 to \$750,000 and significantly higher**, often with a direct P&L participation component.³
    """)

    st.subheader("🤔 Considerations")
    st.warning("""
    The two-year career break may present a hurdle in this highly competitive and fast-paced segment,
    where recent market experience and an active network are prized. A compelling narrative for the
    break, coupled with demonstrated recent engagement with the markets (e.g., through personal
    investing, research, or relevant coursework) and strong networking, will be critical.
    """)

st.divider()

# --- Section B: Energy Transition & Sustainable Finance ---
st.header("B. Energy Transition & Sustainable Finance 🌱")
st.caption("(ESG, Climate Finance, Renewables Investment)")

with st.expander("Explore Energy Transition & Sustainable Finance Roles"):
    st.subheader("📝 Description")
    st.markdown("""
    This rapidly expanding field encompasses a variety of roles focused on financing, investing in,
    and advising on sustainable energy projects, integrating ESG factors into investment processes,
    and managing climate-related financial risks and opportunities.
    """)

    st.markdown("##### Key Role Examples:")
    st.markdown("""
    * **Project Finance Analyst/Associate (Renewables):** Involves financial modeling, due diligence,
        risk assessment, and transaction support for renewable energy projects (solar, wind, battery storage).
        The Arevon "Analyst, Project Finance & Investment" role is a good example, requiring 1-3 years
        of experience, strong Excel modeling skills, and understanding of project financing structures.²³
        *Your financial modeling expertise is directly transferable.*
    * **ESG Analyst/Associate/VP:** Focuses on researching and integrating material ESG factors into
        investment analysis, engaging with companies on sustainability, developing ESG policies, and
        contributing to ESG reporting.²⁴ A senior role like a VP of Sustainable Investing can command
        **\$220,000-\$260,000** (10+ years experience).²⁵ *Your analytical rigor is a key asset here.*
    * **Climate Finance Specialist:** Involves analyzing climate risks/opportunities, carbon markets,
        developing climate-related financial products, and structuring green financing. Employers include
        city agencies, banks (e.g., JPMC's Climate Macroeconomic Modeler), and advisory firms.²⁶
    * **Investment Roles (Energy Transition Funds):** Sourcing, evaluating, executing, and managing
        investments in clean energy technologies and infrastructure. Major players include Brookfield
        Asset Management and Blackstone.¹
    """)

    st.subheader("🎯 Relevance")
    st.markdown("""
    Your deep understanding of the energy sector provides an invaluable foundation. Your analytical skills,
    financial modeling capabilities, and experience in forming macro views are highly transferable to
    assessing renewable energy projects and the broader energy transition. Your **MIT Physics degree**
    adds credibility, particularly when evaluating new technologies.
    """)

    st.subheader("🏙️ NYC Demand & Employers")
    st.markdown("""
    This is a high-growth area in NYC. Key employers include investment banks (e.g., Citi¹), global
    asset managers (e.g., BlackRock, Morgan Stanley²), specialized funds (e.g., Arevon²³, Brookfield¹),
    consulting firms, and public/quasi-public entities like NYSERDA.²⁷
    """)

    st.subheader("💰 Estimated NYC Salary Range")
    st.markdown("""
    * **Analyst roles:** Typically **\$80,000 to \$150,000**.
    * **Vice President level:** Can range from **\$150,000 to \$260,000+**, with further upside in
        investment roles tied to fund performance.¹
    """)

    st.subheader("🤔 Considerations")
    st.info("""
    While your core skills are transferable, demonstrating a genuine interest and foundational
    knowledge in sustainability concepts, ESG frameworks, and renewable energy technologies
    (perhaps through recent courses or certifications) will be beneficial.
    """)

st.divider()

# --- Section C: Quantitative Finance & Advanced Analytics ---
st.header("C. Quantitative Finance & Advanced Analytics 🧮")
st.caption("(Capitalizing on MIT Physics and Analytical Acumen)")

with st.expander("Dive into Quantitative Finance & Advanced Analytics Roles"):
    st.subheader("📝 Description")
    st.markdown("""
    These roles involve the development, implementation, and validation of quantitative models for
    trading strategies, risk management, portfolio construction, asset pricing, or algorithmic
    execution. They typically require strong mathematical and statistical skills, along with
    proficiency in programming languages such as Python, SQL, and C++.
    """)

    st.subheader("🎯 Relevance")
    st.markdown("""
    Your **Bachelor of Science in Physics from MIT** is a significant asset and a common educational
    background for quantitative finance professionals. Your experience in building complex financial
    models (e.g., localized supply-demand models, US natural gas production cost curves) demonstrates
    strong quantitative aptitude and analytical rigor.
    """)
    st.success("Your MIT Physics degree is a strong credential here!")

    st.subheader("🏙️ NYC Demand & Employers")
    st.markdown("""
    Demand for quantitative talent is consistently high in NYC. Employers include systematic hedge
    funds, quantitative trading desks at investment banks, proprietary trading firms, and asset
    managers. Selby Jennings lists roles such as:
    * "Quantitative Power Trader" (**\$150,000-\$200,000 + PnL split**)¹²
    * "Quantitative Analyst" (**\$300,000-\$400,000**) for equity market making¹⁵
    * "Quantitative Developer" (**\$175,000-\$250,000**)¹²
    Google also has Financial Analyst positions requiring a quantitative field degree.¹⁴
    """)

    st.subheader("💰 Estimated NYC Salary Range")
    st.markdown("""
    Compensation is highly competitive, often with substantial performance-based bonuses. Base
    salaries for experienced individuals can range from **\$150,000 to \$400,000+**.¹²
    """)

    st.subheader("🤔 Considerations")
    st.info("""
    While your physics degree is strong, you may need to demonstrate recent proficiency in relevant
    programming languages (Python, SQL) and familiarity with current quantitative finance techniques.
    Your energy sector expertise could be a unique selling point for quantitative roles with an
    energy or commodities focus.
    """)

st.divider()

# --- Section D: Financial Risk Management ---
st.header("D. Financial Risk Management 🛡️")
st.caption("(Applying Analytical Rigor to Market and Credit Risk)")

with st.expander("Understand Financial Risk Management Roles"):
    st.subheader("📝 Description")
    st.markdown("""
    Professionals in financial risk management are responsible for identifying, measuring, monitoring,
    and mitigating various financial risks, including market risk, credit risk, liquidity risk, and
    operational risk, within financial institutions or corporations.
    """)

    st.subheader("🎯 Relevance")
    st.markdown("""
    Your experience in managing risk within investment portfolios (e.g., "responsible for the vast
    majority of the team’s beta-neutral risk deployment"), your deep understanding of market drivers
    in the energy sector, and your rigorous fundamental analysis skills are highly applicable. The
    analytical discipline from your physics education is also a key asset.
    """)

    st.subheader("🏙️ NYC Demand & Employers")
    st.markdown("""
    Steady demand in NYC's financial services. Employers include investment banks, commercial banks,
    asset managers, insurance companies, and regulatory bodies. Selby Jennings lists roles like:
    * "VP Resolution Planning"
    * "Director of Corporate Credit"
    * "Counterparty Credit Risk VP" (**\$170,000-\$180,000**)
    * "Senior Risk Manager Options/Volatility" (**\$200,000-\$250,000 + bonus**)¹⁸
    ZipRecruiter and NYS DFS also list various risk management positions.¹⁹ ¹⁷
    """)

    st.subheader("💰 Estimated NYC Salary Range")
    st.markdown("""
    AVP and VP level roles often command salaries in the **\$150,000 to \$250,000+** range, with
    senior roles earning substantially more.¹⁸
    """)

    st.subheader("🤔 Considerations")
    st.info("""
    Highlighting specific instances where your analytical skills led to successful risk mitigation
    will be important. Certifications like the FRM (Financial Risk Manager) could enhance your candidacy.
    """)

st.divider()

# --- Section E: Corporate Strategy & Development within Energy Companies ---
st.header("E. Corporate Strategy & Development within Energy Companies 🏭")
st.caption("(Broader Strategic Impact)")

with st.expander("Explore Corporate Strategy & Development Roles"):
    st.subheader("📝 Description")
    st.markdown("""
    Situated within energy companies (traditional oil & gas, utilities, renewable developers), these
    roles involve strategic planning, market analysis, M&A, new business development, and navigating
    the energy transition.
    """)

    st.subheader("🎯 Relevance")
    st.markdown("""
    Your profound understanding of the energy sector, financial modeling skills, and macro-level
    view formation experience would be invaluable. Your experience influencing fund views also
    demonstrates strategic thinking.
    """)

    st.subheader("🏙️ NYC Demand & Employers")
    st.markdown("""
    While many HQs are elsewhere, significant operations or strategic offices exist in/near NYC,
    or offer hybrid/remote roles. Potential employers:
    * Utilities: Con Edison³⁴, National Grid³⁶
    * Renewable Developers: Ørsted³⁸, NextEra Energy⁴⁰ (check location specifics)
    * Other: Energy Solution (remote/hybrid roles)⁴²
    """)

    st.subheader("💰 Estimated NYC Salary Range")
    st.markdown("""
    Highly variable. Examples:
    * Strategy Manager (Con Edison): **\$100,000-\$140,000**³⁴
    * Manager, Strategy, Policy & Regulatory (National Grid): **\$152,000-\$179,000**³⁷
    """)

    st.subheader("🤔 Considerations")
    st.info("""
    Offers a shift from pure financial markets to direct involvement in energy businesses' operational
    and strategic growth. Appealing if seeking broader impact on the energy transition from within an
    operating company.
    """)

st.divider()

# --- Section F: Commodities Trading & Analysis ---
st.header("F. Commodities Trading & Analysis ⛽")
st.caption("(Deepening Energy Sector Specialization)")

with st.expander("Delve into Commodities Trading & Analysis Roles"):
    st.subheader("📝 Description")
    st.markdown("""
    Involves analyzing physical and financial commodity markets (crude oil, natural gas, power,
    refined products, renewable energy credits), developing trading strategies, executing trades,
    or providing analytical support.
    """)

    st.subheader("🎯 Relevance")
    st.markdown("""
    A natural extension of your deep energy sector expertise. Your experience building localized
    supply-demand models and US natural gas production cost curves (Morgan Stanley) is highly relevant.
    """)

    st.subheader("🏙️ NYC Demand & Employers")
    st.markdown("""
    NYC is a major center. Employers:
    * Investment banks with commodities desks (e.g., J.P. Morgan Chase²⁰)
    * Specialized energy trading firms
    * Commodity-focused hedge funds
    * Utilities with trading arms
    * BP (Power Trade Analyst, NYC/Houston): **\$107,000-\$153,000**⁴³
    """)

    st.subheader("💰 Estimated NYC Salary Range")
    st.markdown("""
    * **Analyst roles (supporting trading):** **\$75,000 to \$150,000+**²⁰
    * **Commodities Traders:** Salaries vary enormously based on P&L, can be very substantial.⁴⁵
    """)

    st.subheader("🤔 Considerations")
    st.info("""
    While your background is equity L/S, analytical skills are transferable. Roles in financial
    commodities analysis or supporting trading desks would be a closer fit than physical trading.⁴⁷
    """)

st.divider()

# --- Summary Table ---
st.header("Table 1: Summary of High-Demand Adjacent Roles in NYC for Your Profile 📊")
st.markdown("""
To provide a consolidated view, the following table summarizes these promising career pathways,
linking them to your core skills and providing realistic employer and salary expectations based
on current market data.
""")

# Data for the table
data = {
    "Role Category": [
        "Energy PM & Hedge Fund Analyst",
        "Energy Transition & Sustainable Finance",
        "Quantitative Finance",
        "Financial Risk Management",
        "Corporate Strategy (Energy Co.)",
        "Commodities Trading & Analysis"
    ],
    "Specific Job Titles": [
        "Energy Portfolio Manager, Equity L/S Analyst (Energy)",
        "Project Finance Analyst (Renewables), ESG Analyst, Climate Finance Specialist, Investment Associate (Energy Transition)",
        "Quantitative Analyst, Quantitative Trader, Quantitative Developer",
        "Market Risk Manager, Credit Risk Analyst, Counterparty Risk VP",
        "Strategy Manager, Business Development Manager",
        "Commodities Analyst, Trade Support Analyst, Power Trader"
    ],
    "Key NYC Employers (Examples from Research)": [
        "Hedge Funds (Millennium, Citadel type), Asset Managers (Selby Jennings listings)",
        "Banks (Citi), Asset Managers (BlackRock), Specialized Funds (Arevon, Brookfield), NYSERDA",
        "Hedge Funds (Systematic), Investment Banks, Prop Trading Firms (Selby Jennings listings)",
        "Investment Banks, Commercial Banks, Asset Managers (Selby Jennings listings, NYS DFS)",
        "Utilities (Con Edison, National Grid), Renewable Developers (Ørsted, NextEra)",
        "Investment Banks (JPMC), Energy Trading Firms (BP)"
    ],
    "Core Skills Leveraged from Your Resume": [
        "Portfolio Management, Equity Analysis, Risk Management, Energy Sector Expertise, Financial Modeling",
        "Financial Modeling, Sector Analysis, Due Diligence, Macro Analysis, Quantitative Skills",
        "MIT Physics, Advanced Financial Modeling, Statistical Analysis, Programming (if current)",
        "Risk Analysis, Portfolio Risk Management, Fundamental Analysis, Quantitative Aptitude",
        "Energy Sector Knowledge, Financial Analysis, Strategic Thinking, Market Assessment",
        "Energy Market Analysis, Supply-Demand Modeling, Financial Modeling, Quantitative Skills"
    ],
    "Estimated NYC Salary Range (Annual, from Research)": [
        "\$150k - \$750k+ (3)",
        "\$80k - \$260k+ (1)",
        "\$150k - \$400k+ (12)",
        "\$150k - \$250k+ (17)",
        "\$100k - \$180k+ (34)",
        "\$75k - \$150k+ (Analyst); Trader varies (20)"
    ]
}
df = pd.DataFrame(data)

# Display the table using Streamlit's dataframe component for better formatting
st.dataframe(df, hide_index=True, use_container_width=True, column_config={
        "Role Category": st.column_config.TextColumn(width="small"),
        "Specific Job Titles": st.column_config.TextColumn(width="small"),
        "Key NYC Employers (Examples from Research)": st.column_config.TextColumn(width="large"),
        "Core Skills Leveraged from Your Resume": st.column_config.TextColumn(width="small"),
        "Estimated NYC Salary Range (Annual, from Research)": st.column_config.TextColumn(width="small")
    })

st.markdown("""
*This comparative overview should aid in prioritizing your job search efforts by highlighting
the avenues where your skillset aligns most strongly with market demand and compensation expectations.*
""")

st.divider()
st.caption("Disclaimer: This page is based on the provided text. Citation numbers (e.g., ³, ¹²) refer to sources in the original document.")

# To run this Streamlit app:
# 1. Save this code as a Python file (e.g., adjacent_careers_app.py).
# 2. Open your terminal or command prompt.
# 3. Navigate to the directory where you saved the file.
# 4. Run the command: streamlit run adjacent_careers_app.py
